class <- c_pcaSpectra(SrE.IR, choice = "autoscale")#
mclustSpectra(SrE.IR, class, main = "Cuticle IR", plot = "BIC")#
mclustSpectra(SrE.IR, class, main = "Cuticle IR", plot = "proj")
mclustSpectra(SrE.IR, class, main = "Cuticle IR", plot = "error",#
	truth = metMUD1$groups)
?sprintf
?rowDist
?requireNamespace
plotSpectraJS <- function(spectra, browser = NULL, minify = TRUE) {#
	if (missing(spectra)) stop("No spectral data provided")#
	chkSpectra(spectra)#
	if (is.unsorted(spectra$freq)) {#
		spectra$freq <- rev(spectra$freq)#
		spectra$data <- spectra$data[,ncol(spectra$data):1]#
		}#
#
	if (requireNamespace("jsonlite", quietly = TRUE)) {#
		Freq <- toJSON(spectra$freq)#
		D0 <- toJSON(spectra$data)#
		D1 <- toJSON(spectra$data)#
		Names <- toJSON(paste(" ", spectra$names, sep = "  "))#
		Groups <- toJSON(spectra$groups)#
		Colors <- toJSON(spectra$colors)#
		Unit <- toJSON(spectra$unit)#
		Desc <- toJSON(spectra$desc)#
		Dx <- toJSON(range(spectra$freq))#
		Dy <- toJSON(range(spectra$data))#
	 	sampleBOOL <- c(1L, rep(0, length(spectra$names)-1))#
		sampleBOOL <- toJSON(sampleBOOL)#
		data1 <- paste("var Freq = ", Freq, sep = "")#
		data2 <- paste("var D0 = ", D0, sep = "")#
		data3 <- paste("var D1 = ", D1, sep = "")#
		data4 <- paste("var Names = ", Names, sep = "")#
		data5 <- paste("var Groups = ", Groups, sep = "")#
		data6 <- paste("var Colors = ", Colors, sep = "")#
		data7 <- paste("var Unit = ", Unit, sep = "")#
		data8 <- paste("var Desc = ", Desc, sep = "")#
		data9 <- paste("var Dx = ", Dx, sep = "")#
		data10 <- paste("var Dy = ", Dy, sep = "")#
		data11 <- paste("var sampleBOOL = ", sampleBOOL, sep = "")#
		td <- tempdir()#
		fd <- system.file("extdata", package = "ChemoSpec")#
		pSfiles <- c("pS.css", "pS_globals.js", "pS_controls.js",#
		"pS_brushNguides.js", "pS_main.js", "plotSpectraJS.html", "pS_spectra.js")#
		chk2 <- file.copy(from=file.path(fd, pSfiles), to=file.path(td, pSfiles),#
			overwrite = TRUE)#
		if (!all(chk2)) stop("Copying to temporary directory failed")#
		js1 <- readLines(con = file.path(td,"pS_globals.js"))#
		js2 <- readLines(con = file.path(td,"pS_brushNguides.js"))#
		js3 <- readLines(con = file.path(td,"pS_controls.js"))#
		js4 <- readLines(con = file.path(td,"pS_spectra.js"))#
		js5 <- readLines(con = file.path(td,"pS_main.js"))#
		scopeFunHeader <- "(function() {"#
		scopeFunTail <- "})();"#
		text = c(scopeFunHeader, data1, data2, data3, data4,#
			data5, data6, data7, data8, data9, data10, data11,#
			js1, js2, js3, js4, js5, scopeFunTail)#
		if (minify) {#
			if (requireNamespace("js", quietly = TRUE)) {#
				text <- js::uglify_optimize(text, unused = FALSE)#
				}#
			if (!requireNamespace("js", quietly = TRUE)) {#
				stop("You need install package js to minify the JavaScript code")#
				}#
			}#
		writeLines(text, sep  = "\n", con = file.path(td,"pS.js"))#
		pg <-  file.path(td,"plotSpectraJS.html")#
		if (!is.null(browser)) {#
		    browseURL(pg, browser = browser)#
			} else {#
				viewer <- getOption("viewer")#
			  	if (is.null(browser) && !is.null(viewer)) {#
		      		viewer(pg)#
			  		} else {#
			    		browseURL(pg)#
			  			}#
			}#
		message("The plotSpectraJS web page is in the following\ntemp directory which is deleted when you quit R: ")#
		message(td)#
		return(invisible())#
	}#
	if (!requireNamespace("jsonlite", quietly = TRUE)) {#
		stop("You need install package jsonlite to use this function")#
		}#
	}
groupNcolor <-#
function(spectra, gr.crit = NULL, gr.cols = c("auto")) {#
	spectra$groups <- rep(NA, length(spectra$names)) #
	for (i in 1:length(gr.crit)) {#
		which <- grep(gr.crit[i], spectra$names)#
		if (length(which) == 0) warning("There was no match for gr.crit value ", gr.crit[i], " among the file names")#
		spectra$groups[which] <- gr.crit[i]#
		}#
	spectra$groups <- as.factor(spectra$groups)#
	if (any(is.na(spectra$groups))) warning("At least one file name did not correspond any entry in gr.crit and its group is thus NA")#
	spectra$colors <- rep(NA, length(spectra$names)) #
	if (identical(gr.cols[1], "auto")) {#
		if (requireNamespace("RColorBrewer", quietly = TRUE)) {#
			gr.cols <- RColorBrewer::brewer.pal(length(gr.crit), "Set1")#
			for (i in 1:length(gr.crit)) {#
				which <- grep(gr.crit[i], spectra$names)#
				spectra$colors[which] <- gr.cols[i]#
				}#
			}#
		if (!requireNamespace("RColorBrewer", quietly = TRUE)) {#
			stop("You need install package RColorBrewer or supply the colors yourself")#
			}#
		}#
	if (!identical(gr.cols[1], "auto")) {#
		for (i in 1:length(gr.crit)) {#
			which <- grep(gr.crit[i], spectra$groups)#
			spectra$colors[which] <- gr.cols[i]#
			}#
		}#
	sym.choice <- c(1, 2, 3, 15, 16, 17, 22, 8) #
	sym1 <- sym.choice[1:length(gr.crit)]#
	sym2 <- letters[1:length(gr.crit)]#
	if (length(gr.crit) > 8) {#
		sym1 <- c(1:length(gr.crit))#
		warning("Too many groups to use the preferred symbols!")#
		}#
#
	for (i in 1:length(gr.crit)) {#
		which <- grep(gr.crit[i], spectra$groups)#
		spectra$sym[which] <- sym1[i]#
		spectra$alt.sym[which] <- sym2[i]#
		}#
	class(spectra) <- "Spectra"#
	return(spectra) #
	}
sessionInfo()
RColorBrewer::brewer.pal(5, "set1")
RColorBrewer::brewer.pal(5, "Set1")
library('ChemoSpec')
?baselineSpectra
?exists
?try
?hasArg
b <- 1:1000#
a <- pi*b
a
ncb <- nchar(as.character(b))
head(ncb)
ncb
head(a)
pi
as.character(pi)
library("mclust")
citation("mclust")
library("sos")
findFn("cvsegments")
findFn("pcaPP")
getMaxCovByFreq <- function(spectra, V = NULL, Quan = NULL) {#
	abs_cov = NULL #
	if (is.null(V)) stop("You must supply a covariance matrix")#
#
	cv <- rep(NA_real_, nrow(V))#
	for (i in 1:nrow(V)) {#
		cvmin <- min(V[i,])  #
		cvmax <- max(V[i,])  #
		if (abs(cvmax) >= abs(cvmin)) cv[i] <- cvmax #
		if (abs(cvmin) > abs(cvmax)) cv[i] <- cvmin#
		}#
	cva <- abs(cv)	#
	df <- data.frame(freq = spectra$freq, cov = cv, abs_cov = cva)#
	df <- arrange(df, desc(abs_cov))#
	df$rel_abs_cov <- df$abs_cov/df$abs_cov[1]#
	if (!is.null(Quan)) {#
		if (!length(Quan) == 1) stop("Quan should be a single number")#
		Quan <- 1 - Quan#
		Q <- quantile(abs_cov, Quan)#
		df <- subset(df, abs_cov >= Q)#
		}#
	return(df)#
	}
ls()
?covSpectra
data(metMUD2)#
lvs <- c(-0.99, -0.95, -0.9, 0.9, 0.95, 0.99)#
lim <- c(0.6, 4.3)#
res <- corSpectra(metMUD2, levels = lvs, limX = lim, limY = lim, main = "metMUD2 NMR Data")#
jnk <- covSpectra(metMUD2, freq = 1.030, C = res[[2]], V = res[[1]])
jnk <- covSpectra(metMUD2, freq = 1.030, C = res[[2]], V = res[[1]], yFREE = TRUE)
?floor
?pretty
data(metMUD2)
library("ChemoSpec")
jnk <- covSpectra(metMUD2, freq = 1.030, C = res[[2]], V = res[[1]], yFree = TRUE)
res <- corSpectra(metMUD2, levels = c(-0.95, 0.95))
rx <- range(x <- 10*1:nrow(volcano))#
ry <- range(y <- 10*1:ncol(volcano))#
ry <- ry + c(-1, 1) * (diff(rx) - diff(ry))/2#
tcol <- terrain.colors(12)#
par(opar); opar <- par(pty = "s", bg = "lightcyan")
opar <- par(mfrow = c(2, 2), mar = rep(0, 4))
par(opar); opar <- par(pty = "s", bg = "lightcyan")#
plot(x = 0, y = 0, type = "n", xlim = rx, ylim = ry, xlab = "", ylab = "")
u <- par("usr")#
rect(u[1], u[3], u[2], u[4], col = tcol[8], border = "red")
contour(x, y, volcano, col = tcol[2], lty = "solid", add = TRUE,#
        vfont = c("sans serif", "plain"))
?plot
?contour
library("seriation")
?terrain.colors
data("Wood")#
hmap(Wood)
?hmap
